<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0063)http://www.cnpc/EX_STATICPAGES_/DisplayOnPageStatic20151230.htm -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>信息资源网 首页天气预报显示</title>
<script type="text/javascript" src="jquery-1.3.2.min.js"></script>


<style type="text/css">
body{margin:0; padding:0;font-size:12px;}
.texttq { COLOR: #b1b1b1; LINE-HEIGHT: 12px; FONT-FAMILY: "微软雅黑"; LETTER-SPACING: 0px; TEXT-DECORATION: none}
A.texttq:hover {COLOR: #c30}
.weather_img {WIDTH: 57px; HEIGHT: 41px;BORDER:solid white 0px; FLOAT: left; MARGIN-RIGHT: 5px; }
</style>

</head>

<body marginwidth="0" marginheight="0">
<a href="http://www.cnpc/gsxx/gsjs/Pages/tqyb.aspx" target="_blank" title="更多天气情况" class="texttq">
    <table width="290" height="14" valign="top">
    <tbody><tr>
    <td>
       </td> 
     <td> 
             <span id="LabelName">北京</span> 温度:<span id="LabelTemperature">19℃~8℃</span> 风力:<span id="LabelWind">小于3</span>级
         </td>
    </tr>
 
    </tbody></table>   
</a>




<script type="text/javascript">
    jQuery.getWindowName = function(url,callback){
        if(!url || typeof url !== 'string'){return;}
        url += (url.indexOf('?') > 0 ? '&' : '?') + 'remote='+(+new Date());
        var frame = $('<iframe style="display:none;"></iframe>').appendTo("body");
        var state = 0;
        frame.load(function(){
            if(state === 0){
                state = 1;
                frame[0].contentWindow.location = "none.htm";
            }else{
                var data = frame[0].contentWindow.name;
                frame.remove();
                if(callback && typeof callback === 'function'){
                    callback(data);
                }
            }
        }).attr("src",url);
    };

	$.getWindowName("http://eiptool.cnpc/weather/DisplayOnPageRemote.aspx",function(data){ 
      //alert(data);
	  //载入数据
	  var jsonData;
	  try{
		jsonData = eval("(" + data + ")");
		modifyHTML(jsonData);
		}
	  catch(e){}
  });


function modifyHTML(jsonData)
{
	var arrData = new Array("ImgWeather","LabelName","LabelTemperature","LabelWind");
	var i = arrData.length;
	while (i--) {
		if(jsonData[arrData[i]] != undefined && jsonData[arrData[i]] != null) setData(arrData[i],jsonData[arrData[i]]);
	}
}

function setData(e,v)
{
	var o = document.getElementById(e);
	if (o.tagName == "IMG") { o.alt = v; o.src = alt2src(v)}
	else o.innerHTML = v; 
}

function alt2src(alt)
{
    var tq = "晴|多云|阴|小雨|中雨|大雨|暴雨|阵雨|雷阵雨|雨夹雪|小雪|中雪|大雪|阵雪|雾|扬沙|大暴雨|暴雨到大暴雨|冻雨|雷阵雨伴有冰雹|暴雪|小到中雪|中到大雪|大到暴雪|浮尘|沙尘暴|小到中雨|中到大雨|大到暴雨|默认|霾|中度霾|重度霾|严重霾";
    tq = tq.split("|");
    var tp = "qing.gif|dy.gif|yin.gif|xy.gif|zy.gif|day.gif|by.gif|zheny.gif|lzy.gif|yjx.gif|xx.gif|zx.gif|dx.gif|zhenx.gif|wu.gif|ys.gif|by.gif|by.gif|yjx.gif|lzy.gif|dx.gif|zx.gif|dx.gif|dx.gif|ys.gif|ys.gif|zy.gif|day.gif|by.gif|space.gif|mai.gif|mai.gif|mai.gif|mai.gif";;
	tp = tp.split("|");
	var path = "..\\PageAssets\\Images\\weather\\";
	var a= tq.length-1;
	for(var i=0; i<tq.length ; i++)
	{
		//判断预设图片，返回图片地址
		if (tq[i] == alt)
		{
			//a = i;
			return path + tp[i];
			break;
		}

		//无预设图片时，返回默认图space.gif地址
		if (a == i)
		{
			return path + tp[i];
			break;
		}
	}
}
</script></body></html>